id: com.eduke32.EDuke32.Plugin.DukeNukem3DShareware
branch: 1-3.32
runtime: com.eduke32.EDuke32
runtime-version: stable
sdk: org.gnome.Sdk//3.32
build-extension: true
separate-locales: false
appstream-compose: false
modules: 
  - name: DukeNukem3DShareware
    buildsystem: simple
    build-commands: 
      - install -D apply_extra "${FLATPAK_DEST}/bin/apply_extra"
    post-install:
      - install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo com.eduke32.EDuke32.Plugin.DukeNukem3DShareware.appdata.xml
      - appstream-compose --basename=com.eduke32.EDuke32.Plugin.DukeNukem3DShareware --prefix=${FLATPAK_DEST} --origin=flatpak com.eduke32.EDuke32.Plugin.DukeNukem3DShareware
    sources: 
      - type: extra-data
        filename: 3dduke13.zip
#        url: ftp://ftp.3drealms.com/share/3dduke13.zip
        url: https://archive.org/download/3dduke13/3dduke13.zip
        sha256: c67efd179022bc6d9bde54f404c707cbcbdc15423c20be72e277bc2bdddf3d0e
        size: 5924374
      - type: script
        dest-filename: apply_extra
        commands:
          - unzip 3dduke13.zip
          - unzip -Lu "DN3DSW13.SHR" defs.con duke.rts game.con user.con duke3d.grp
          - install -m644 duke.rts {defs,game,user}.con duke3d.grp ${FLATPAK_DEST}
      - type: file
        path: com.eduke32.EDuke32.Plugin.DukeNukem3DShareware.appdata.xml
