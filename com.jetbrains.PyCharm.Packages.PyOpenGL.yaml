id: com.jetbrains.PyCharm.Packages.PyOpenGL
branch: "20.08"
runtime: com.jetbrains.PyCharm-Community
runtime-version: stable
sdk: org.freedesktop.Sdk//20.08
build-extension: true
appstream-compose: false
build-options: 
  prefix: ${FLATPAK_DEST}
  env:
    CPATH: :/app/packages/PyOpenGL/include
modules:
  - shared-modules/glew/glew.json
  - shared-modules/glu/glu-9.json

  - name: freeglut
    builddir: true
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DOpenGL_GL_PREFERENCE=LEGACY
      - -DFREEGLUT_BUILD_DEMOS=OFF
      - -DCMAKE_INSTALL_LIBDIR:PATH=/app/packages/PyOpenGL/lib
      - -DFREEGLUT_BUILD_STATIC_LIBS=OFF
      - -Wno-dev
    sources:
      - type: archive
        url: https://downloads.sourceforge.net/freeglut/freeglut-3.2.1.tar.gz
        sha256: d4000e02102acaf259998c870e25214739d1f16f67f99cb35e4f46841399da68
      - type: patch
        path: freeglut-3.2.1-gcc10_fix-1.patch

  - name: PyOpenGL
    buildsystem: simple
    build-commands:
      - pip3 install --no-index --find-links="file://${PWD}" --target=${FLATPAK_DEST}/python
        PyOpenGL
      - install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo com.jetbrains.PyCharm.Packages.PyOpenGL.metainfo.xml
    sources:
      - type: file
        url: https://files.pythonhosted.org/packages/b8/73/31c8177f3d236e9a5424f7267659c70ccea604dab0585bfcd55828397746/PyOpenGL-3.1.5.tar.gz
        sha256: 4107ba0d0390da5766a08c242cf0cf3404c377ed293c5f6d701e457c57ba3424
      - type: file
        path: com.jetbrains.PyCharm.Packages.PyOpenGL.metainfo.xml
